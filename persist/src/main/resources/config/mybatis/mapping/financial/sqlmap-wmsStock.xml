<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="wmsStock">

    <sql id="selectWmsStockDetails">
        select IWSK.SKU_CODE "skuCode",
        IWSK.MATERIAL_CODE "materialCode",
        IWSK.SKU_NAME "skuName",
        IWWR.WARES_NAME "goodsName",
        IWWR.MEASURE_UNIT "measureUnit",
        IWS.SALES_QUANTITY + IWS.OCCUPY_QUANTITY "acceptedGoods",
        IWS.UNSALES_QUANTITY "defectiveGoods",
        IWS.TOTAL_QUANTITY "totalGoods"
        from SYN_WMS_STOCK IWS
        left join SYN_WMS_WAREHOUSE IWW
        on IWW.ID = IWS.WAREHOUSE_ID
        left join SYN_WMS_SKU IWSK
        on IWSK.ID = IWS.SKU_ID
        left join SYN_WMS_WARES IWWR
        on IWWR.ID = IWSK.WARES_ID
        <where>
            IWW.WAREHOUSE_CODE = '0769'
            <if test="beginDate != null">
                AND IWSK.CREATE_TIME <![CDATA[ >= ]]> to_date(#beginDate#,'yyyy-mm-dd')
            </if>
            <if test="endDate != null">
                AND IWSK.CREATE_TIME <![CDATA[ < ]]> to_date(#endDate#,'yyyy-mm-dd')+1
            </if>
        </where>
        order by IWSK.SKU_CODE
    </sql>

</mapper>